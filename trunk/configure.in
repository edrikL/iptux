#                                               -*- Autoconf -*-
# Process this file with autoconf to produce a configure script.

AC_PREREQ(2.61)
AC_INIT(configure.in)
AC_CONFIG_SRCDIR(src/iptux.cpp)
AM_CONFIG_HEADER(config.h)
AM_INIT_AUTOMAKE(iptux, 0.4.5)

# Checks for programs.
AC_PROG_CXX
AC_PROG_CC
AC_PROG_CPP
AC_PROG_AWK
AC_PROG_INSTALL
AC_PROG_LN_S
AC_PROG_MAKE_SET
AC_PROG_RANLIB
AC_PROG_MKDIR_P
#CXXFLAGS=-O3
#AC_SUBST(CXXFLAGS)
#CFLAGS=-O3
#AC_SUBST(CFLAGS)

# Checks for libraries.
# FIXME: Replace `main' with a function in `-lcairo':
#AC_CHECK_LIB([cairo], [main])
# FIXME: Replace `main' with a function in `-ldl':
#AC_CHECK_LIB([dl], [main])
# FIXME: Replace `main' with a function in `-lrt':
#AC_CHECK_LIB([rt], [main])

# Checks for header files.
AC_HEADER_DIRENT
AC_HEADER_STDC
AC_CHECK_HEADERS([arpa/inet.h fcntl.h netinet/in.h stdint.h stdlib.h string.h strings.h sys/ioctl.h sys/socket.h sys/time.h unistd.h])

# Checks for typedefs, structures, and compiler characteristics.
AC_HEADER_STDBOOL
AC_C_CONST
AC_TYPE_MODE_T
AC_TYPE_SIZE_T
AC_TYPE_SSIZE_T
AC_HEADER_TIME
AC_TYPE_UINT16_T
AC_TYPE_UINT32_T
AC_TYPE_UINT64_T
AC_TYPE_UINT8_T

# Checks for library functions.
AC_FUNC_CLOSEDIR_VOID
AC_PROG_GCC_TRADITIONAL
AC_FUNC_MALLOC
AC_TYPE_SIGNAL
AC_FUNC_STAT
AC_FUNC_VPRINTF
AC_CHECK_FUNCS([bzero getcwd gettimeofday inet_ntoa memmove mkdir socket strcasecmp strchr strerror strncasecmp strpbrk strrchr strstr])

AC_DEFINE(__IP_TUX__)
AC_ARG_ENABLE(message,
		[  --disable-message       disable print message], ,
		enable_message=yes)
if test "$enable_message" = yes ; then
AC_DEFINE(MESSAGE)
fi
AC_ARG_ENABLE(warning,
		[  --disable-warning       disable print warning], ,
		enable_warning=yes)
if test "$enable_warning" = yes ; then
AC_DEFINE(WARNING)
fi
AC_ARG_ENABLE(trace,
		[  --enable-trace          enable print trace], ,
		enable_trace=no)
if test "$enable_trace" = yes ; then
AC_DEFINE(TRACE)
fi

gtk_modules="gtk+-2.0 >= 2.0.0"
PKG_CHECK_MODULES(GTK, [$gtk_modules])
AC_SUBST(GTK_CFLAGS)
AC_SUBST(GTK_LIBS)
gthread_modules="gthread-2.0 >= 2.0.0"
PKG_CHECK_MODULES(GTHREAD, [$gthread_modules])
AC_SUBST(GTHREAD_CFLAGS)
AC_SUBST(GTHREAD_LIBS)
gconf_modules="gconf-2.0 >= 2.0.0"
PKG_CHECK_MODULES(GCONF, [$gconf_modules])
AC_SUBST(GCONF_CFLAGS)
AC_SUBST(GCONF_LIBS)
GETTEXT_PACKAGE=iptux
AC_SUBST(GETTEXT_PACKAGE)

dnl Add the languages which your application supports here.
ALL_LINGUAS="zh_CN"
AM_GLIB_GNU_GETTEXT

AC_OUTPUT(Makefile \
	desktop/Makefile \
	pixmaps/Makefile \
	src/Makefile \
	po/Makefile.in)
